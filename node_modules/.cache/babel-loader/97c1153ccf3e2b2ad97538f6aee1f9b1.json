{"ast":null,"code":"import WalletConnect from \"@walletconnect/client\";\nimport QRCodeModal from \"@walletconnect/qrcode-modal\";\nimport HttpConnection from \"@walletconnect/http-connection\";\nimport { payloadId, signingMethods, parsePersonalSign, getRpcUrl } from \"@walletconnect/utils\";\nconst ProviderEngine = require(\"web3-provider-engine\");\nconst CacheSubprovider = require(\"web3-provider-engine/subproviders/cache\");\nconst FixtureSubprovider = require(\"web3-provider-engine/subproviders/fixture\");\nconst FilterSubprovider = require(\"web3-provider-engine/subproviders/filters\");\nconst HookedWalletSubprovider = require(\"web3-provider-engine/subproviders/hooked-wallet\");\nconst NonceSubprovider = require(\"web3-provider-engine/subproviders/nonce-tracker\");\nconst SubscriptionsSubprovider = require(\"web3-provider-engine/subproviders/subscriptions\");\nclass WalletConnectProvider extends ProviderEngine {\n  constructor(opts) {\n    super({\n      pollingInterval: opts.pollingInterval || 8000\n    });\n    this.bridge = \"https://bridge.walletconnect.org\";\n    this.qrcode = true;\n    this.qrcodeModal = QRCodeModal;\n    this.qrcodeModalOptions = undefined;\n    this.rpc = null;\n    this.infuraId = \"\";\n    this.http = null;\n    this.isConnecting = false;\n    this.connected = false;\n    this.connectCallbacks = [];\n    this.accounts = [];\n    this.chainId = 1;\n    this.rpcUrl = \"\";\n    this.enable = async () => {\n      const wc = await this.getWalletConnector();\n      if (wc) {\n        this.start();\n        this.subscribeWalletConnector();\n        return wc.accounts;\n      } else {\n        throw new Error(\"Failed to connect to WalleConnect\");\n      }\n    };\n    this.request = async payload => {\n      return this.send(payload);\n    };\n    this.send = async (payload, callback) => {\n      var _a;\n      if (typeof payload === \"string\") {\n        const method = payload;\n        let params = callback;\n        if (method === \"personal_sign\") {\n          params = parsePersonalSign(params);\n        }\n        return this.sendAsyncPromise(method, params);\n      }\n      payload = Object.assign({\n        id: payloadId(),\n        jsonrpc: \"2.0\"\n      }, payload);\n      if (payload.method === \"personal_sign\") {\n        payload.params = parsePersonalSign(payload.params);\n      }\n      if (callback) {\n        this.sendAsync(payload, callback);\n        return;\n      }\n      if (payload.method === \"eth_signTypedData_v4\" && ((_a = this.walletMeta) === null || _a === void 0 ? void 0 : _a.name) === \"MetaMask\") {\n        const {\n          result\n        } = await this.handleOtherRequests(payload);\n        return result;\n      } else {\n        return this.sendAsyncPromise(payload.method, payload.params);\n      }\n    };\n    this.onConnect = callback => {\n      this.connectCallbacks.push(callback);\n    };\n    this.triggerConnect = result => {\n      if (this.connectCallbacks && this.connectCallbacks.length) {\n        this.connectCallbacks.forEach(callback => callback(result));\n      }\n    };\n    this.bridge = opts.connector ? opts.connector.bridge : opts.bridge || \"https://bridge.walletconnect.org\";\n    this.qrcode = typeof opts.qrcode === \"undefined\" || opts.qrcode !== false;\n    this.qrcodeModal = opts.qrcodeModal || this.qrcodeModal;\n    this.qrcodeModalOptions = opts.qrcodeModalOptions;\n    this.wc = opts.connector || new WalletConnect({\n      bridge: this.bridge,\n      qrcodeModal: this.qrcode ? this.qrcodeModal : undefined,\n      qrcodeModalOptions: this.qrcodeModalOptions,\n      storageId: opts === null || opts === void 0 ? void 0 : opts.storageId,\n      signingMethods: opts === null || opts === void 0 ? void 0 : opts.signingMethods,\n      clientMeta: opts === null || opts === void 0 ? void 0 : opts.clientMeta\n    });\n    this.rpc = opts.rpc || null;\n    if (!this.rpc && (!opts.infuraId || typeof opts.infuraId !== \"string\" || !opts.infuraId.trim())) {\n      throw new Error(\"Missing one of the required parameters: rpc or infuraId\");\n    }\n    this.infuraId = opts.infuraId || \"\";\n    this.chainId = (opts === null || opts === void 0 ? void 0 : opts.chainId) || this.chainId;\n    this.initialize();\n  }\n  get isWalletConnect() {\n    return true;\n  }\n  get connector() {\n    return this.wc;\n  }\n  get walletMeta() {\n    return this.wc.peerMeta;\n  }\n  async disconnect() {\n    this.close();\n  }\n  async close() {\n    const wc = await this.getWalletConnector({\n      disableSessionCreation: true\n    });\n    await wc.killSession();\n    await this.onDisconnect();\n  }\n  async handleRequest(payload) {\n    try {\n      let response;\n      let result = null;\n      const wc = await this.getWalletConnector();\n      switch (payload.method) {\n        case \"wc_killSession\":\n          await this.close();\n          result = null;\n          break;\n        case \"eth_accounts\":\n          result = wc.accounts;\n          break;\n        case \"eth_coinbase\":\n          result = wc.accounts[0];\n          break;\n        case \"eth_chainId\":\n          result = wc.chainId;\n          break;\n        case \"net_version\":\n          result = wc.chainId;\n          break;\n        case \"eth_uninstallFilter\":\n          this.sendAsync(payload, _ => _);\n          result = true;\n          break;\n        default:\n          response = await this.handleOtherRequests(payload);\n      }\n      if (response) {\n        return response;\n      }\n      return this.formatResponse(payload, result);\n    } catch (error) {\n      this.emit(\"error\", error);\n      throw error;\n    }\n  }\n  async handleOtherRequests(payload) {\n    if (!signingMethods.includes(payload.method) && payload.method.startsWith(\"eth_\")) {\n      return this.handleReadRequests(payload);\n    }\n    const wc = await this.getWalletConnector();\n    const result = await wc.sendCustomRequest(payload);\n    return this.formatResponse(payload, result);\n  }\n  async handleReadRequests(payload) {\n    if (!this.http) {\n      const error = new Error(\"HTTP Connection not available\");\n      this.emit(\"error\", error);\n      throw error;\n    }\n    return this.http.send(payload);\n  }\n  formatResponse(payload, result) {\n    return {\n      id: payload.id,\n      jsonrpc: payload.jsonrpc,\n      result: result\n    };\n  }\n  getWalletConnector() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      disableSessionCreation = false\n    } = opts;\n    return new Promise((resolve, reject) => {\n      const wc = this.wc;\n      if (this.isConnecting) {\n        this.onConnect(x => resolve(x));\n      } else if (!wc.connected && !disableSessionCreation) {\n        this.isConnecting = true;\n        wc.on(\"modal_closed\", () => {\n          reject(new Error(\"User closed modal\"));\n        });\n        wc.createSession({\n          chainId: this.chainId\n        }).then(() => {\n          wc.on(\"connect\", (error, payload) => {\n            if (error) {\n              this.isConnecting = false;\n              return reject(error);\n            }\n            this.isConnecting = false;\n            this.connected = true;\n            if (payload) {\n              this.updateState(payload.params[0]);\n            }\n            this.emit(\"connect\");\n            this.triggerConnect(wc);\n            resolve(wc);\n          });\n        }).catch(error => {\n          this.isConnecting = false;\n          reject(error);\n        });\n      } else {\n        if (!this.connected) {\n          this.connected = true;\n          this.updateState(wc.session);\n        }\n        resolve(wc);\n      }\n    });\n  }\n  async subscribeWalletConnector() {\n    const wc = await this.getWalletConnector();\n    wc.on(\"disconnect\", error => {\n      if (error) {\n        this.emit(\"error\", error);\n        return;\n      }\n      this.onDisconnect();\n    });\n    wc.on(\"session_update\", (error, payload) => {\n      if (error) {\n        this.emit(\"error\", error);\n        return;\n      }\n      this.updateState(payload.params[0]);\n    });\n  }\n  async onDisconnect() {\n    await this.stop();\n    this.emit(\"close\", 1000, \"Connection closed\");\n    this.emit(\"disconnect\", 1000, \"Connection disconnected\");\n    this.connected = false;\n  }\n  async updateState(sessionParams) {\n    const {\n      accounts,\n      chainId,\n      networkId,\n      rpcUrl\n    } = sessionParams;\n    if (!this.accounts || accounts && this.accounts !== accounts) {\n      this.accounts = accounts;\n      this.emit(\"accountsChanged\", accounts);\n    }\n    if (!this.chainId || chainId && this.chainId !== chainId) {\n      this.chainId = chainId;\n      this.emit(\"chainChanged\", chainId);\n    }\n    if (!this.networkId || networkId && this.networkId !== networkId) {\n      this.networkId = networkId;\n      this.emit(\"networkChanged\", networkId);\n    }\n    this.updateRpcUrl(this.chainId, rpcUrl || \"\");\n  }\n  updateRpcUrl(chainId) {\n    let rpcUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n    const rpc = {\n      infuraId: this.infuraId,\n      custom: this.rpc || undefined\n    };\n    rpcUrl = rpcUrl || getRpcUrl(chainId, rpc);\n    if (rpcUrl) {\n      this.rpcUrl = rpcUrl;\n      this.updateHttpConnection();\n    } else {\n      this.emit(\"error\", new Error(`No RPC Url available for chainId: ${chainId}`));\n    }\n  }\n  updateHttpConnection() {\n    if (this.rpcUrl) {\n      this.http = new HttpConnection(this.rpcUrl);\n      this.http.on(\"payload\", payload => this.emit(\"payload\", payload));\n      this.http.on(\"error\", error => this.emit(\"error\", error));\n    }\n  }\n  sendAsyncPromise(method, params) {\n    return new Promise((resolve, reject) => {\n      this.sendAsync({\n        id: payloadId(),\n        jsonrpc: \"2.0\",\n        method,\n        params: params || []\n      }, (error, response) => {\n        if (error) {\n          reject(error);\n          return;\n        }\n        resolve(response.result);\n      });\n    });\n  }\n  initialize() {\n    this.updateRpcUrl(this.chainId);\n    this.addProvider(new FixtureSubprovider({\n      eth_hashrate: \"0x00\",\n      eth_mining: false,\n      eth_syncing: true,\n      net_listening: true,\n      web3_clientVersion: `WalletConnect/v1.x.x/javascript`\n    }));\n    this.addProvider(new CacheSubprovider());\n    this.addProvider(new SubscriptionsSubprovider());\n    this.addProvider(new FilterSubprovider());\n    this.addProvider(new NonceSubprovider());\n    this.addProvider(new HookedWalletSubprovider(this.configWallet()));\n    this.addProvider({\n      handleRequest: async (payload, next, end) => {\n        try {\n          const {\n            error,\n            result\n          } = await this.handleRequest(payload);\n          end(error, result);\n        } catch (error) {\n          end(error);\n        }\n      },\n      setEngine: _ => _\n    });\n  }\n  configWallet() {\n    return {\n      getAccounts: async cb => {\n        try {\n          const wc = await this.getWalletConnector();\n          const accounts = wc.accounts;\n          if (accounts && accounts.length) {\n            cb(null, accounts);\n          } else {\n            cb(new Error(\"Failed to get accounts\"));\n          }\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signMessage([msgParams.from, msgParams.data]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processPersonalMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signPersonalMessage([msgParams.data, msgParams.from]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processSignTransaction: async (txParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signTransaction(txParams);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processTransaction: async (txParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.sendTransaction(txParams);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processTypedMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signTypedData([msgParams.from, msgParams.data]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      }\n    };\n  }\n}\nexport default WalletConnectProvider;","map":{"version":3,"names":["WalletConnect","QRCodeModal","HttpConnection","payloadId","signingMethods","parsePersonalSign","getRpcUrl","ProviderEngine","require","CacheSubprovider","FixtureSubprovider","FilterSubprovider","HookedWalletSubprovider","NonceSubprovider","SubscriptionsSubprovider","WalletConnectProvider","constructor","opts","pollingInterval","bridge","qrcode","qrcodeModal","qrcodeModalOptions","undefined","rpc","infuraId","http","isConnecting","connected","connectCallbacks","accounts","chainId","rpcUrl","enable","wc","getWalletConnector","start","subscribeWalletConnector","Error","request","payload","send","callback","method","params","sendAsyncPromise","Object","assign","id","jsonrpc","sendAsync","_a","walletMeta","name","result","handleOtherRequests","onConnect","push","triggerConnect","length","forEach","connector","storageId","clientMeta","trim","initialize","isWalletConnect","peerMeta","disconnect","close","disableSessionCreation","killSession","onDisconnect","handleRequest","response","_","formatResponse","error","emit","includes","startsWith","handleReadRequests","sendCustomRequest","arguments","Promise","resolve","reject","x","on","createSession","then","updateState","catch","session","stop","sessionParams","networkId","updateRpcUrl","custom","updateHttpConnection","addProvider","eth_hashrate","eth_mining","eth_syncing","net_listening","web3_clientVersion","configWallet","next","end","setEngine","getAccounts","cb","processMessage","msgParams","signMessage","from","data","processPersonalMessage","signPersonalMessage","processSignTransaction","txParams","signTransaction","processTransaction","sendTransaction","processTypedMessage","signTypedData"],"sources":["../../src/index.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module"}