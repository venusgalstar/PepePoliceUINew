{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar xml_http_request_event_target_1 = require(\"./xml-http-request-event-target\");\nvar XMLHttpRequestUpload = /** @class */function (_super) {\n  __extends(XMLHttpRequestUpload, _super);\n  function XMLHttpRequestUpload() {\n    var _this = _super.call(this) || this;\n    _this._contentType = null;\n    _this._body = null;\n    _this._reset();\n    return _this;\n  }\n  XMLHttpRequestUpload.prototype._reset = function () {\n    this._contentType = null;\n    this._body = null;\n  };\n  XMLHttpRequestUpload.prototype._setData = function (data) {\n    if (data == null) {\n      return;\n    }\n    if (typeof data === 'string') {\n      if (data.length !== 0) {\n        this._contentType = 'text/plain;charset=UTF-8';\n      }\n      this._body = new Buffer(data, 'utf-8');\n    } else if (Buffer.isBuffer(data)) {\n      this._body = data;\n    } else if (data instanceof ArrayBuffer) {\n      var body = new Buffer(data.byteLength);\n      var view = new Uint8Array(data);\n      for (var i = 0; i < data.byteLength; i++) {\n        body[i] = view[i];\n      }\n      this._body = body;\n    } else if (data.buffer && data.buffer instanceof ArrayBuffer) {\n      var body = new Buffer(data.byteLength);\n      var offset = data.byteOffset;\n      var view = new Uint8Array(data.buffer);\n      for (var i = 0; i < data.byteLength; i++) {\n        body[i] = view[i + offset];\n      }\n      this._body = body;\n    } else {\n      throw new Error(\"Unsupported send() data \" + data);\n    }\n  };\n  XMLHttpRequestUpload.prototype._finalizeHeaders = function (headers, loweredHeaders) {\n    if (this._contentType && !loweredHeaders['content-type']) {\n      headers['Content-Type'] = this._contentType;\n    }\n    if (this._body) {\n      headers['Content-Length'] = this._body.length.toString();\n    }\n  };\n  XMLHttpRequestUpload.prototype._startUpload = function (request) {\n    if (this._body) {\n      request.write(this._body);\n    }\n    request.end();\n  };\n  return XMLHttpRequestUpload;\n}(xml_http_request_event_target_1.XMLHttpRequestEventTarget);\nexports.XMLHttpRequestUpload = XMLHttpRequestUpload;","map":{"version":3,"names":["xml_http_request_event_target_1","require","XMLHttpRequestUpload","_super","__extends","_this","call","_contentType","_body","_reset","prototype","_setData","data","length","Buffer","isBuffer","ArrayBuffer","body","byteLength","view","Uint8Array","i","buffer","offset","byteOffset","Error","_finalizeHeaders","headers","loweredHeaders","toString","_startUpload","request","write","end","XMLHttpRequestEventTarget","exports"],"sources":["../xml-http-request-upload.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script"}